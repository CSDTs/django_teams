{% extends 'base.html' %}
{% load teams %}

{% block page-header %}
    <h1>Teams <small>all created teams</small></h1>
{% endblock %}

{% block content %}
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Team Name</th>
                <th>Team Owners</th>
                <th># of members</th>
                <th>Your status</th>
            </tr>
        </thead>
        {% for object in object_list %}
        <tr>
            <td><a href="{% url 'team-detail' pk=object.id %}">{{ object }}</a></td>
            <td>
                {% for owner in object.owners %}
                    {% if forloop.last %}
                        {{ owner }}
                    {% else %}
                        {{ owner}}, 
                    {% endif %}
                {% endfor %}
            </td>
            <td>{{ object.member_count }}</td>
            <td>
                {% if user.is_authenticated %}
                    {% with ts=object|get_user_status:user %}
                        {% if ts == None %}
                            -
                        {% elif ts.role == 1 %}
                            Pending approval
                        {% elif ts.role == 10 %}
                            Member
                        {% elif ts.role == 20 %}
                            Team Leader
                        {% endif %}
                    {% endwith %}
                {% else %}
                    You're not logged in!
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}
